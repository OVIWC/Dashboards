"0",""
"0","setwd('C:/Users/envir/Documents/106/Well Hydrographs')"
"0",""
"0","#Create list all csv files (except BS2)"
"0","temp <- list.files(""C:/Users/envir/Documents/106/Well Hydrographs/Data"", full.names = TRUE, pattern = ""\\.csv$"")"
"0",""
"0","#Read list of csv files, tidy"
"0","raw_data <- readr::read_csv(temp, id = ""Well"", skip = 11, col_types = cols(`Date and Time` = col_datetime(format = ""%m/%d/%Y %H:%M:%S %p""))) %>%"
"0","  select(1:6) %>%"
"0","  mutate(Well = str_extract_all(Well, ""..-Res-."")) %>%"
"0","  mutate(Well = as.character(Well))"
"0",""
"0","# Tidying and reconfigure, keep only new data"
"0","newdb <- raw_data %>%"
"0","  pivot_longer(cols = 4:6, names_to = 'CharacteristicName', values_to = 'ResultMeasureValue') %>%"
"0","  rename(MONLOC_AB = Well) %>%"
"0","  mutate(StartDate = date(`Date and Time`)) %>%"
"0","  mutate(StartTime = strftime(`Date and Time`, ""%H:%M"")) %>%"
"0","  mutate(DataLoggerLineName = '2023') %>%"
"0","  mutate(Deployment = '2023') %>%"
"0","  mutate(ProjectIdentifier = case_when((MONLOC_AB == 'LP-Res-4' | MONLOC_AB == 'LP-Res-5' | MONLOC_AB == 'LP-Res-6') ~ 'GWQM-LP',"
"0","                (MONLOC_AB == 'BP-Res-3' | MONLOC_AB == 'BP-Res-4') ~ 'GWQM-BP',"
"0","                (MONLOC_AB == 'BS-Res-1' | MONLOC_AB == 'BS-Res-2') ~ 'BSGW')) %>%"
"0","  mutate(Date= strftime(`Date and Time`, ""%Y%m%d"")) %>%"
"0","  mutate (ActivityIdentifier = glue('{MONLOC_AB}-{Date}-GW')) %>%"
"0","  mutate(ActivityMediaName = 'Water') %>%"
"0","  mutate(CharacteristicName = case_when(CharacteristicName == 'Level Depth To Water (ft)' ~ 'Depth', CharacteristicName == 'Pressure (PSI)' ~ 'Pressure', CharacteristicName == 'Temperature (F)' ~ 'Temperature, water')) %>%"
"0","  mutate(ResultMeasureUnitCode = case_when(CharacteristicName == 'Depth' ~ 'ft', CharacteristicName == 'Pressure' ~ 'psi', CharacteristicName == 'Temperature, water' ~ 'deg F')) %>%"
"0","  mutate(DataType = 'Raw') %>%"
"0","  mutate(UseForCalc = 1) %>%"
"0","  mutate(COMMENTS = '') %>%"
"0","  select(MONLOC_AB, StartDate, StartTime, DataLoggerLineName, Deployment, ProjectIdentifier, ActivityIdentifier, ActivityMediaName, CharacteristicName, ResultMeasureValue, ResultMeasureUnitCode, DataType, UseForCalc, COMMENTS) %>%"
"0","  mutate(datetime = as.POSIXct(paste(StartDate, StartTime), format = ""%Y-%m-%d %H:%M"")) %>%"
"0","  left_join(GW_last_datapoint, by = ""MONLOC_AB"") %>%"
"0","  filter(datetime.x > datetime.y) %>%"
"0","  select(-datetime.x, -datetime.y)"
"0","  "
"0",""
"0","filename <- paste(""NewCSVsforDB/"", format(Sys.time(), ""%Y-%m-%d""),""newGWData.csv"")"
"0",""
"0","write_csv(newdb, filename)"
"0","                           "
